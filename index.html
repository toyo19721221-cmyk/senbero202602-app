<!doctype html>
<html lang="ja" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç³¸å³¶ã‚»ãƒ³ãƒ™ãƒ­ 2026</title>
  
  <link rel="manifest" href="manifest.json">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/1161/1161684.png">

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+New:wght@400;700;900&display=swap" rel="stylesheet">
  
  <style>
    body { box-sizing: border-box; font-family: 'Zen Kaku Gothic New', sans-serif; -webkit-tap-highlight-color: transparent; }
    .shop-card { transition: all 0.2s ease; cursor: pointer; }
    .shop-card:active { transform: scale(0.97); }
    #video-container { position: relative; width: 100%; max-width: 400px; aspect-ratio: 1/1; overflow: hidden; border-radius: 1.5rem; border: 4px solid white; box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1); }
    #video { width: 100%; height: 100%; object-fit: cover; }
    .scan-line { position: absolute; width: 100%; height: 3px; background: #ff6b6b; top: 0; left: 0; animation: scan 2s linear infinite; }
    @keyframes scan { 0% { top: 0; } 100% { top: 100%; } }
    .progress-glow { box-shadow: 0 4px 20px rgba(255, 107, 107, 0.15); }
  </style>
</head>
<body class="h-full bg-[#fff5e6] text-[#2d3436]">
  <div id="app" class="w-full h-full overflow-auto pb-12"></div>

  <script>
    // PWAã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ã®ç™»éŒ²
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js').then(() => console.log('Service Worker Registered'));
    }

    const shopNames = ["ITO GRAND", "ç³¸å³¶ãƒ©ãƒ¼ãƒ¡ãƒ³ ã ãã€œå®¶", "è‹¥æ­¦è€…", "Klootch", "é›… MIYABI", "Darts&Karaoke Bar BASE", "ç„¼è‚‰è¾›éººã‚ˆã—ã¾ã‚‹", "ãƒ’ãƒã‚ã‚‹", "ãƒ¯ã‚«ãƒ ã‚·ãƒ£ãƒã‚¨ãƒãƒ«", "å®´Bar Y's style", "ãƒ€ãƒ¼ãƒ„ãƒãƒ¼chance", "èŠ‹æ—¦é‚£", "RE:LOAD", "ç·‘", "R.Garden", "Golf&Bar Rosa Brillante", "ã‚„ãã¨ã‚Š ã„ã¨", "ãƒ¬ãƒˆãƒ­é…’å ´ã‚«ãƒ©ã‚¯ãƒª", "two out", "AIRU", "å®´é…’å ´ãƒãƒã‚“å®¶", "girl's dining bar MII", "ã‚«ãƒ©ã‚ªã‚± ãƒ¯ã‚¤ãƒ¯ã‚¤ãƒœãƒƒã‚¯ã‚¹", "Puchi-Rose", "music bar en ãƒŸãƒ¥ãƒ¼ã‚¸ãƒƒã‚¯ãƒãƒ¼ ã‚¨ãƒ³/ç¸"];

    const referenceShops = shopNames.map((name, i) => ({
      id: `shop_${i + 1}`,
      name: name,
      address: "ç¦å²¡çœŒç³¸å³¶å¸‚å‰åŸä¸­å¤®è¿‘è¾º",
      tel: "092-000-0000",
      food: "æœŸé–“é™å®šãŠã™ã™ã‚ãƒ¡ãƒ‹ãƒ¥ãƒ¼",
      qrCode: `QR_${i + 1}`,
      description: "ç³¸å³¶ã®å¤œã‚’æ¥½ã—ã‚€ç´ æ•µãªãŠåº—ã§ã™ã€‚è‡ªæ…¢ã®ã‚»ãƒ³ãƒ™ãƒ­ãƒ•ãƒ¼ãƒ‰ã‚’ãŠæ¥½ã—ã¿ãã ã•ã„ï¼",
      image: "https://images.unsplash.com/photo-1514362545857-3bc16c4c7d1b?w=400"
    }));

    let visitedShops = JSON.parse(localStorage.getItem('senbero_visited')) || [];
    let videoStream = null;

    function renderApp() {
      const visitedCount = visitedShops.length;
      const progressPercent = (visitedCount / referenceShops.length) * 100;
      const app = document.getElementById('app');
      
      let shopListHtml = referenceShops.map(shop => {
        const isVisited = visitedShops.some(v => v.shop_id === shop.id);
        return `
          <div onclick="openDetail('${shop.id}')" class="shop-card bg-white p-3 rounded-[1.8rem] shadow-md border-4 ${isVisited ? 'border-[#ff6b6b]' : 'border-white'} relative text-left">
            <div class="flex items-center gap-3">
              <div class="w-14 h-14 rounded-xl bg-gray-100 bg-cover bg-center shrink-0" style="background-image:url('${shop.image}')"></div>
              <div class="flex-1 overflow-hidden">
                <div class="flex justify-between items-start gap-1">
                  <h3 class="font-black text-[13px] leading-tight truncate flex-1">${shop.name}</h3>
                  ${isVisited ? '<span class="text-[#ff6b6b] font-bold text-[8px] bg-red-50 px-1 py-0.5 rounded">âœ“</span>' : ''}
                </div>
                <div class="mt-1">
                  <p class="text-[8px] text-orange-400 font-bold uppercase"><span>ğŸ´</span> ãƒ•ãƒ¼ãƒ‰</p>
                  <p class="text-[10px] font-bold text-[#ff6b6b] truncate">${shop.food}</p>
                </div>
              </div>
            </div>
          </div>
        `;
      }).join('');

      app.innerHTML = `
        <div class="max-w-3xl mx-auto p-4">
          <div class="bg-blue-500 text-white p-3 rounded-2xl mb-6 text-xs font-bold flex justify-between items-center shadow-lg">
            <span>ğŸ“± ãƒ›ãƒ¼ãƒ ç”»é¢ã«è¿½åŠ ã™ã‚‹ã¨ãƒ‡ãƒ¼ã‚¿ãŒä¿è­·ã•ã‚Œã¾ã™</span>
          </div>

          <header class="text-center my-6">
            <h1 class="text-3xl font-black text-[#ff6b6b] tracking-tighter">ç³¸å³¶ã‚»ãƒ³ãƒ™ãƒ­ 2026</h1>
          </header>
          
          <div class="sticky top-4 z-[1000] bg-white/95 backdrop-blur-md p-5 rounded-[2rem] shadow-xl border border-white mb-8 progress-glow">
            <div class="flex justify-between items-center mb-2 px-1">
              <p class="text-xs font-bold text-gray-400">ã‚¹ã‚¿ãƒ³ãƒ—é”æˆåº¦</p>
              <p class="text-xl font-black text-[#ff6b6b]">${visitedCount}<span class="text-sm text-gray-300"> / ${referenceShops.length}</span></p>
            </div>
            <div class="w-full h-3 bg-gray-100 rounded-full overflow-hidden">
              <div class="h-full bg-[#ff6b6b] transition-all duration-1000" style="width:${progressPercent}%"></div>
            </div>
          </div>

          <div class="flex justify-center gap-3 mb-8">
            <button onclick="openGuide()" class="flex-1 bg-white text-gray-400 font-bold py-4 rounded-2xl shadow-sm border border-gray-100 text-sm">â“ ä½¿ã„æ–¹</button>
            <button onclick="openScanner()" class="flex-[3] bg-[#ff6b6b] text-white font-bold py-4 rounded-2xl shadow-lg flex items-center justify-center gap-2">ğŸ“¸ QRã‚³ãƒ¼ãƒ‰èª­ã¿è¾¼ã¿</button>
          </div>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
            ${shopListHtml}
          </div>

          ${visitedCount === referenceShops.length ? `
            <div class="bg-gradient-to-br from-yellow-400 to-orange-500 p-8 rounded-[2.5rem] text-white text-center shadow-xl mt-10">
              <p class="font-black text-2xl uppercase tracking-widest">Complete!</p>
              <p class="mt-4 text-sm font-bold opacity-90">å…¨åº—åˆ¶è¦‡ï¼ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼</p>
            </div>
          ` : ''}
        </div>
      `;
    }

    // --- ãƒ¢ãƒ¼ãƒ€ãƒ«åˆ¶å¾¡ãƒ»ã‚¹ã‚­ãƒ£ãƒŠãƒ¼é–¢æ•°ã®è¨˜è¿°ã¯ç¶­æŒ ---
    function openGuide() { document.getElementById('guide-modal').classList.remove('hidden'); }
    function closeGuide() { document.getElementById('guide-modal').classList.add('hidden'); }
    function closeDetail() { document.getElementById('detail-modal').classList.add('hidden'); }
    function openDetail(id) { /* ä»¥å‰ã¨åŒã˜ */ }
    async function openScanner() { /* ä»¥å‰ã¨åŒã˜ */ }
    function closeScanner() { /* ä»¥å‰ã¨åŒã˜ */ }
    function tick() { /* ä»¥å‰ã¨åŒã˜ */ }

    renderApp();
  </script>
</body>
</html>
